import*as e from"react";import t,{localeOption as n}from"primereact/api";import{CSSTransition as r}from"primereact/csstransition";import{useMountEffect as a,usePrevious as i,useResizeListener as l,useUpdateEffect as o,useInterval as c,useUnmountEffect as u}from"primereact/hooks";import{TimesIcon as m}from"primereact/icons/times";import{Portal as s}from"primereact/portal";import{Ripple as p}from"primereact/ripple";import{mergeProps as v,classNames as d,IconUtils as f,UniqueComponentId as h,DomHandler as b,ObjectUtils as I,ZIndexUtils as g}from"primereact/utils";import{ComponentBase as y}from"primereact/componentbase";import{ChevronLeftIcon as x}from"primereact/icons/chevronleft";import{ChevronRightIcon as w}from"primereact/icons/chevronright";import{ChevronDownIcon as O}from"primereact/icons/chevrondown";import{ChevronUpIcon as S}from"primereact/icons/chevronup";function E(e){return E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E(e)}function N(e,t){if("object"!==E(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==E(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function P(e){var t=N(e,"string");return"symbol"===E(t)?t:String(t)}function j(e,t,n){return(t=P(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T(e){if(Array.isArray(e))return e}function C(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,l,o=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(o.push(r.value),o.length!==t);c=!0);}catch(e){u=!0,a=e}finally{try{if(!c&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(u)throw a}}return o}}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function A(e,t){if(e){if("string"==typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k(e,t):void 0}}function V(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function D(e,t){return T(e)||C(e,t)||A(e,t)||V()}var H=y.extend({defaultProps:{__TYPE:"Galleria",id:null,value:null,activeIndex:0,fullScreen:!1,item:null,thumbnail:null,indicator:null,caption:null,className:null,closeIcon:null,style:null,header:null,footer:null,numVisible:3,responsiveOptions:null,showItemNavigators:!1,showThumbnailNavigators:!0,showItemNavigatorsOnHover:!1,changeItemOnIndicatorHover:!1,circular:!1,autoPlay:!1,transitionInterval:4e3,showThumbnails:!0,itemNextIcon:null,itemPrevIcon:null,nextThumbnailIcon:null,prevThumbnailIcon:null,thumbnailsPosition:"bottom",verticalThumbnailViewPortHeight:"300px",showIndicators:!1,showIndicatorsOnItem:!1,indicatorsPosition:"bottom",baseZIndex:0,transitionOptions:null,onItemChange:null,children:void 0}});function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){j(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var X=e.memo(e.forwardRef((function(t,n){var r=function(){t.slideShowActive&&t.stopSlideShow&&t.stopSlideShow()},i=function(e){r(),t.onActiveItemChange({index:t.circular&&0===t.activeItemIndex?t.value.length-1:0!==t.activeItemIndex?t.activeItemIndex-1:0}),e&&e.cancelable&&e.preventDefault()},l=function(e){r(),t.onActiveItemChange({index:t.circular&&t.value.length-1===t.activeItemIndex?0:t.activeItemIndex+1}),e&&e.cancelable&&e.preventDefault()},o=function(e){r(),t.onActiveItemChange({index:e})},c=function(e){t.changeItemOnIndicatorHover&&(r(),t.onActiveItemChange({index:e}))},u=function(e,n){13===e.which&&(r(),t.onActiveItemChange({index:n}))};a((function(){t.autoPlay&&t.startSlideShow()}));var m=function(n){var r="p-galleria-indicator-"+n,a=d("p-galleria-indicator",{"p-highlight":t.activeItemIndex===n}),i=t.indicator&&t.indicator(n),l=v({className:a,key:r,tabIndex:0,onClick:function(){return o(n)},onMouseEnter:function(){return c(n)},onKeyDown:function(e){return u(e,n)}},t.ptm("indicator"));return i||(i=e.createElement("button",{type:"button",tabIndex:-1,className:"p-link"},e.createElement(p,null))),e.createElement("li",l,i)},s=t.itemTemplate&&t.itemTemplate(t.value[t.activeItemIndex]),h=function(){if(t.showItemNavigators){var n=!t.circular&&0===t.activeItemIndex,r=d("p-galleria-item-prev p-galleria-item-nav p-link",{"p-disabled":n}),a=v({className:"p-galleria-item-prev-icon"},t.ptm("previousItemIcon")),l=f.getJSXIcon(t.itemPrevIcon||e.createElement(x,a),M({},a),{props:t}),o=v({type:"button",className:r,onClick:i,disabled:n},t.ptm("previousItemButton"));return e.createElement("button",o,l,e.createElement(p,null))}return null}(),b=function(){if(t.showItemNavigators){var n=!t.circular&&t.activeItemIndex===t.value.length-1,r=d("p-galleria-item-next p-galleria-item-nav p-link",{"p-disabled":n}),a=v({className:"p-galleria-item-next-icon"},t.ptm("nextItemIcon")),i=f.getJSXIcon(t.itemNextIcon||e.createElement(w,a),M({},a),{props:t}),o=v({type:"button",className:r,onClick:l,disabled:n},t.ptm("nextItemButton"));return e.createElement("button",o,i,e.createElement(p,null))}return null}(),I=function(){var n=v({className:"p-galleria-caption"},t.ptm("caption"));if(t.caption){var r=t.caption(t.value[t.activeItemIndex]);return e.createElement("div",n,r)}return null}(),g=function(){if(t.showIndicators){for(var n=d("p-galleria-indicators p-reset",t.indicatorsContentClassName),r=[],a=v({className:n},t.ptm("indicators")),i=0;i<t.value.length;i++)r.push(m(i));return e.createElement("ul",a,r)}return null}(),y=v({ref:n,className:"p-galleria-item-wrapper"},t.ptm("itemWrapper")),O=v({className:"p-galleria-item-container"},t.ptm("itemContainer")),S=v({className:"p-galleria-item"},t.ptm("item"));return e.createElement("div",y,e.createElement("div",O,h,e.createElement("div",S,s),b,I),g)})));function B(e){if(Array.isArray(e))return k(e)}function G(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function J(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function W(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?W(Object(n),!0).forEach((function(t){j(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}X.displayName="GalleriaItem";var Z=e.memo((function(t){var n=t.active?0:null,r=t.template&&t.template(t.item),a=d("p-galleria-thumbnail-item",{"p-galleria-thumbnail-item-current":t.current,"p-galleria-thumbnail-item-active":t.active,"p-galleria-thumbnail-item-start":t.start,"p-galleria-thumbnail-item-end":t.end},t.className),i=v({className:a},t.ptm("thumbnailItem")),l=v({className:"p-galleria-thumbnail-item-content",tabIndex:n,onClick:function(e){t.onItemClick({originalEvent:e,index:t.index})},onKeyDown:function(e){13===e.which&&t.onItemClick({originalEvent:e,index:t.index})}},t.ptm("thumbnailItemContent"));return e.createElement("div",i,e.createElement("div",l,r))})),K=e.memo(e.forwardRef((function(n,r){var c=D(e.useState(n.numVisible),2),u=c[0],m=c[1],s=D(e.useState(0),2),g=s[0],y=s[1],E=e.useRef(null),N=e.useRef(null),P=e.useRef(""),j=e.useRef(null),T=e.useRef(null),C=i(u),k=i(n.activeItemIndex),V=D(l({listener:function(){Q()},when:n.responsiveOptions}),1)[0],H=function(e){var t=g+e;e<0&&-1*t+u>n.value.length-1?t=u-n.value.length:e>0&&t>0&&(t=0),n.circular&&(e<0&&n.value.length-1===n.activeItemIndex?t=0:e>0&&0===n.activeItemIndex&&(t=u-n.value.length)),E.current&&(b.removeClass(E.current,"p-items-hidden"),E.current.style.transform=n.isVertical?"translate3d(0, ".concat(t*(100/u),"%, 0)"):"translate3d(".concat(t*(100/u),"%, 0, 0)"),E.current.style.transition="transform 500ms ease 0s"),y(t)},R=function(){n.slideShowActive&&n.stopSlideShow&&n.stopSlideShow()},M=function(){var e=Math.floor(u/2);return u%2?e:e-1},X=function(e){R();var t=0!==n.activeItemIndex?n.activeItemIndex-1:0;u-(t+g)-1>M()&&(-1*g!=0||n.circular)&&H(1),n.onActiveItemChange({index:n.circular&&0===n.activeItemIndex?n.value.length-1:t}),e.cancelable&&e.preventDefault()},W=function(e){R();var t=n.activeItemIndex+1;t+g>M()&&(-1*g<q()-1||n.circular)&&H(-1),n.onActiveItemChange({index:n.circular&&n.value.length-1===n.activeItemIndex?0:t}),e.cancelable&&e.preventDefault()},K=function(e){R();var t=e.index;if(t!==n.activeItemIndex){var r=t+g,a=0;t<n.activeItemIndex?(a=u-r-1-M())>0&&-1*g!=0&&H(a):(a=M()-r)<0&&-1*g<q()-1&&H(a),n.onActiveItemChange({index:t})}},_=function(e){E.current&&"transform"===e.propertyName&&(b.addClass(E.current,"p-items-hidden"),E.current.style.transition="")},z=function(e){var t=e.changedTouches[0];N.current={x:t.pageX,y:t.pageY}},L=function(e){e.cancelable&&e.preventDefault()},U=function(e){var t=e.changedTouches[0];$(e,n.isVertical?t.pageY-N.current.y:t.pageX-N.current.x)},$=function(e,t){t<0?W(e):X(e)},q=function(){return n.value.length>u?n.value.length-u+1:0},F=function(){j.current||(j.current=b.createInlineStyle(t.nonce));var e,r="\n            .p-galleria-thumbnail-items[".concat(P.current,"] .p-galleria-thumbnail-item {\n                flex: 1 0 ").concat(100/u,"%\n            }\n        ");if(n.responsiveOptions){T.current=B(e=n.responsiveOptions)||G(e)||A(e)||J(),T.current.sort((function(e,n){return I.sort(e.breakpoint,n.breakpoint,-1,t.locale,t.nullSortOrder)}));for(var a=0;a<T.current.length;a++){var i=T.current[a];r+="\n                    @media screen and (max-width: ".concat(i.breakpoint,") {\n                        .p-galleria-thumbnail-items[").concat(P.current,"] .p-galleria-thumbnail-item {\n                            flex: 1 0 ").concat(100/i.numVisible,"%\n                        }\n                    }\n                ")}}j.current.innerHTML=r},Q=function(){if(E.current&&T.current){for(var e=window.innerWidth,t={numVisible:n.numVisible},r=0;r<T.current.length;r++){var a=T.current[r];parseInt(a.breakpoint,10)>=e&&(t=a)}u!==t.numVisible&&m(t.numVisible)}};a((function(){E.current&&(P.current=h(),E.current.setAttribute(P.current,"")),F(),Q(),V()})),o((function(){var e=g;C===u&&k===n.activeItemIndex||((e=n.activeItemIndex<=M()?0:n.value.length-u+M()<n.activeItemIndex?u-n.value.length:n.value.length-u<n.activeItemIndex&&u%2==0?-1*n.activeItemIndex+M()+1:-1*n.activeItemIndex+M())!==g&&y(e),E.current.style.transform=n.isVertical?"translate3d(0, ".concat(e*(100/u),"%, 0)"):"translate3d(".concat(e*(100/u),"%, 0, 0)"),k!==n.activeItemIndex&&(b.removeClass(E.current,"p-items-hidden"),E.current.style.transition="transform 500ms ease 0s"))}));var ee,te,ne,re,ae,ie,le,oe=function(){if(n.showThumbnailNavigators){var t=!n.circular&&0===n.activeItemIndex||n.value.length<=u,r=d("p-galleria-thumbnail-prev p-link",{"p-disabled":t}),a=v({className:"p-galleria-thumbnail-prev-icon"},n.ptm("previousThumbnailIcon")),i=f.getJSXIcon(n.isVertical?n.prevThumbnailIcon||e.createElement(S,a):n.prevThumbnailIcon||e.createElement(x,a),Y({},a),{props:n}),l=v({className:r,onClick:X,disabled:t},n.ptm("previousThumbnailButton"));return e.createElement("button",l,i,e.createElement(p,null))}return null},ce=function(){if(n.showThumbnailNavigators){var t=!n.circular&&n.activeItemIndex===n.value.length-1||n.value.length<=u,r=d("p-galleria-thumbnail-next p-link",{"p-disabled":t}),a=v({className:"p-galleria-thumbnail-next-icon"},n.ptm("nextThumbnailIcon")),i=f.getJSXIcon(n.isVertical?n.nextThumbnailIcon||e.createElement(O,a):n.nextThumbnailIcon||e.createElement(w,a),Y({},a),{props:n}),l=v({className:r,onClick:W,disabled:t},n.ptm("nextThumbnailButton"));return e.createElement("button",l,i,e.createElement(p,null))}return null},ue=(ee=n.value.map((function(t,r){var a=-1*g,i=a+u-1;return e.createElement(Z,{key:r,index:r,template:n.itemTemplate,item:t,active:a<=r&&i>=r,start:a===r,end:i===r,onItemClick:K,current:n.activeItemIndex===r,ptm:n.ptm})})),te=n.isVertical?n.contentHeight:"",ne=oe(),re=ce(),ae=v({className:"p-galleria-thumbnail-container"},n.ptm("thumbnailContainer")),ie=v({className:"p-galleria-thumbnail-items-container",style:{height:te}},n.ptm("thumbnailItemsContainer")),le=v({ref:E,className:"p-galleria-thumbnail-items",onTransitionEnd:_,onTouchStart:z,onTouchMove:L,onTouchEnd:U},n.ptm("thumbnailItems")),e.createElement("div",ae,ne,e.createElement("div",ie,e.createElement("div",le,ee)),re)),me=v({className:"p-galleria-thumbnail-wrapper"},n.ptm("thumbnailWrapper"));return e.createElement("div",me,ue)})));function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){j(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Z.displayName="GalleriaThumbnailItem",K.displayName="GalleriaThumbnails";var L=e.memo(e.forwardRef((function(a,i){var l=H.getProps(a),o=D(e.useState(!1),2),h=o[0],y=o[1],x=D(e.useState(l.numVisible),2),w=x[0],O=x[1],S=D(e.useState(!1),2),E=S[0],N=S[1],P=D(e.useState(l.activeIndex),2),j=P[0],T=P[1],C=e.useRef(null),k=e.useRef(null),A=e.useRef(null),V=l.onItemChange?l.activeIndex:j,R="left"===l.thumbnailsPosition||"right"===l.thumbnailsPosition,M=H.setMetaData({props:l,state:{visible:h,numVisible:w,slideShowActive:E,activeIndex:j}}).ptm;c((function(){B({index:l.circular&&l.value.length-1===V?0:V+1})}),l.transitionInterval,E);var B=function(e){e.index>=l.value.length?q():l.onItemChange?l.onItemChange(e):T(e.index)},G=function(){y(!0)},J=function(){y(!1)},W=function(){b.addClass(document.body,"p-overflow-hidden")},Y=function(){g.set("modal",A.current,t.autoZIndex,l.baseZIndex||t.zIndex.modal),b.addMultipleClasses(A.current,"p-component-overlay p-component-overlay-enter")},Z=function(){l.onShow&&l.onShow()},_=function(){b.removeClass(document.body,"p-overflow-hidden"),b.addClass(A.current,"p-component-overlay-leave")},L=function(){g.clear(A.current),l.onHide&&l.onHide()},U=function(){return E},$=function(){N(!0)},q=function(){N(!1)},F=function(e,t){var n=["top","left","bottom","right"].find((function(e){return e===t}));return n?"".concat(e,"-").concat(n):""};e.useEffect((function(){l.value&&l.value.length<w&&O(l.value.length)}),[l.value,w]),e.useEffect((function(){O(l.numVisible)}),[l.numVisible]),u((function(){E&&q(),g.clear(A.current)})),e.useImperativeHandle(i,(function(){return{props:l,show:G,hide:J,isAutoPlayActive:U,startSlideShow:$,stopSlideShow:q,getElement:function(){return C.current},getPreviewContent:function(){return k.current}}}));return I.isNotEmpty(l.value)&&function(){var a,i,o,c,u,b,I,g,y,x,O,S,N,P=(o=l.showThumbnails&&F("p-galleria-thumbnails",l.thumbnailsPosition),c=l.showIndicators&&F("p-galleria-indicators",l.indicatorsPosition),u=d("p-galleria p-component",l.className,{"p-galleria-fullscreen":l.fullScreen,"p-galleria-indicator-onitem":l.showIndicatorsOnItem,"p-galleria-item-nav-onhover":l.showItemNavigatorsOnHover&&!l.fullScreen,"p-input-filled":"filled"===t.inputStyle,"p-ripple-disabled":!1===t.ripple},o,c),b=v({className:{className:"p-galleria-close-icon","aria-hidden":!0}},M("closeIcon")),I=f.getJSXIcon(l.closeIcon||e.createElement(m,b),z({},b),{props:l}),g=v({type:"button",className:"p-galleria-close p-link","aria-label":n("close"),onClick:J},M("closeButton")),y=l.fullScreen&&e.createElement("button",g,I,e.createElement(p,null)),a=v({className:"p-galleria-header"},M("header")),x=l.header?e.createElement("div",a,l.header):null,i=v({className:"p-galleria-footer"},M("footer")),O=l.footer?e.createElement("div",i,l.footer):null,S=v({ref:C,id:l.id,className:u,style:l.style},H.getOtherProps(l),M("root")),N=v({className:"p-galleria-content"},M("content")),e.createElement("div",S,y,x,e.createElement("div",N,e.createElement(X,{ref:k,value:l.value,activeItemIndex:V,onActiveItemChange:B,itemTemplate:l.item,circular:l.circular,caption:l.caption,showIndicators:l.showIndicators,itemPrevIcon:l.itemPrevIcon,itemNextIcon:l.itemNextIcon,changeItemOnIndicatorHover:l.changeItemOnIndicatorHover,indicator:l.indicator,showItemNavigators:l.showItemNavigators,autoPlay:l.autoPlay,slideShowActive:E,startSlideShow:$,stopSlideShow:q,ptm:M}),l.showThumbnails&&e.createElement(K,{value:l.value,activeItemIndex:V,onActiveItemChange:B,itemTemplate:l.thumbnail,numVisible:w,nextThumbnailIcon:l.nextThumbnailIcon,prevThumbnailIcon:l.prevThumbnailIcon,responsiveOptions:l.responsiveOptions,circular:l.circular,isVertical:R,contentHeight:l.verticalThumbnailViewPortHeight,showThumbnailNavigators:l.showThumbnailNavigators,autoPlay:l.autoPlay,slideShowActive:E,stopSlideShow:q,ptm:M})),O));if(l.fullScreen){var j=d("p-galleria-mask",{"p-galleria-visible":h}),T=v({ref:A,className:j},M("mask"));return e.createElement(s,{element:e.createElement("div",T,e.createElement(r,{nodeRef:C,classNames:"p-galleria",in:h,timeout:{enter:150,exit:150},options:l.transitionOptions,unmountOnExit:!0,onEnter:W,onEntering:Y,onEntered:Z,onExit:_,onExited:L},P))})}return P}()})));L.displayName="Galleria";export{L as Galleria};
