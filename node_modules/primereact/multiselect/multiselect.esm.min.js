import*as e from"react";import t,{localeOption as n,FilterService as l}from"primereact/api";import{useUpdateEffect as r,useMountEffect as o,useOverlayListener as i,useUnmountEffect as a}from"primereact/hooks";import{ChevronDownIcon as c}from"primereact/icons/chevrondown";import{TimesIcon as u}from"primereact/icons/times";import{TimesCircleIcon as s}from"primereact/icons/timescircle";import{OverlayService as p}from"primereact/overlayservice";import{Tooltip as f}from"primereact/tooltip";import{ObjectUtils as m,DomHandler as d,classNames as b,IconUtils as v,ZIndexUtils as y}from"primereact/utils";import{CSSTransition as h}from"primereact/csstransition";import{Portal as g}from"primereact/portal";import{VirtualScroller as O}from"primereact/virtualscroller";import{CheckIcon as E}from"primereact/icons/check";import{InputText as S}from"primereact/inputtext";import{Ripple as k}from"primereact/ripple";import{SearchIcon as I}from"primereact/icons/search";function x(){return x=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e},x.apply(this,arguments)}function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function C(e,t){if("object"!==w(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var l=n.call(e,t||"default");if("object"!==w(l))return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function N(e){var t=C(e,"string");return"symbol"===w(t)?t:String(t)}function P(e,t,n){return(t=N(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,l=new Array(t);n<t;n++)l[n]=e[n];return l}function F(e){if(Array.isArray(e))return D(e)}function j(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function A(e,t){if(e){if("string"==typeof e)return D(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?D(e,t):void 0}}function L(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function T(e){return F(e)||j(e)||A(e)||L()}function R(e){if(Array.isArray(e))return e}function M(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var l,r,o,i,a=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(l=o.call(n)).done)&&(a.push(l.value),a.length!==t);c=!0);}catch(e){u=!0,r=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw r}}return a}}function V(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function K(e,t){return R(e)||M(e,t)||A(e,t)||V()}var G={defaultProps:{__TYPE:"MultiSelect",appendTo:null,ariaLabelledBy:null,className:null,closeIcon:null,checkboxIcon:null,dataKey:null,disabled:!1,display:"comma",dropdownIcon:null,emptyFilterMessage:null,filter:!1,filterBy:null,filterInputAutoFocus:!0,filterLocale:void 0,filterMatchMode:"contains",filterPlaceholder:null,filterTemplate:null,fixedPlaceholder:!1,flex:!1,id:null,itemCheckboxIcon:null,inline:!1,inputId:null,inputRef:null,itemClassName:null,itemTemplate:null,maxSelectedLabels:null,name:null,onBlur:null,onChange:null,onFilter:null,onFocus:null,onHide:null,onSelectAll:null,onShow:null,optionDisabled:null,optionGroupChildren:null,optionGroupLabel:null,optionGroupTemplate:null,optionLabel:null,optionValue:null,options:null,overlayVisible:!1,panelClassName:null,panelFooterTemplate:null,panelHeaderTemplate:null,panelStyle:null,placeholder:null,removeIcon:null,resetFilterOnHide:!1,scrollHeight:"200px",selectAll:!1,selectedItemTemplate:null,selectedItemsLabel:"{0} items selected",selectionLimit:null,showClear:!1,showSelectAll:!0,style:null,tabIndex:0,tooltip:null,tooltipOptions:null,transitionOptions:null,useOptionAsValue:!1,value:null,virtualScrollerOptions:null,children:void 0},getProps:function(e){return m.getMergedProps(e,G.defaultProps)},getOtherProps:function(e){return m.getDiffProps(e,G.defaultProps)}},H={defaultProps:{__TYPE:"Checkbox",autoFocus:!1,checked:!1,className:null,disabled:!1,falseValue:!1,icon:null,id:null,inputId:null,inputRef:null,name:null,onChange:null,onClick:null,onContextMenu:null,onMouseDown:null,readOnly:!1,required:!1,style:null,tabIndex:null,tooltip:null,tooltipOptions:null,trueValue:!0,value:null,children:void 0},getProps:function(e){return m.getMergedProps(e,H.defaultProps)},getOtherProps:function(e){return m.getDiffProps(e,H.defaultProps)}},J=e.memo(e.forwardRef((function(t,n){var l=H.getProps(t),i=K(e.useState(!1),2),a=i[0],c=i[1],u=e.useRef(null),s=e.useRef(l.inputRef),p=function(e){if(!l.disabled&&!l.readOnly&&(l.onChange||l.onClick)){var t=y(),n=e.target instanceof HTMLDivElement||e.target instanceof HTMLSpanElement||e.target instanceof Object;if(e.target===s.current||n&&e.target.checked!==t){var r=t?l.falseValue:l.trueValue,o={originalEvent:e,value:l.value,checked:r,stopPropagation:function(){e.stopPropagation()},preventDefault:function(){e.preventDefault()},target:{type:"checkbox",name:l.name,id:l.id,value:l.value,checked:r}};if(l.onClick&&l.onClick(o),e.defaultPrevented)return;l.onChange&&l.onChange(o)}d.focus(s.current),e.preventDefault()}},y=function(){return l.checked===l.trueValue};e.useImperativeHandle(n,(function(){return{props:l,focus:function(){return d.focus(s.current)},getElement:function(){return u.current},getInput:function(){return s.current}}})),e.useEffect((function(){m.combinedRefs(s,l.inputRef)}),[s,l.inputRef]),r((function(){s.current.checked=y()}),[l.checked,l.trueValue]),o((function(){l.autoFocus&&d.focus(s.current,l.autoFocus)}));var h=y(),g=m.isNotEmpty(l.tooltip),O=H.getOtherProps(l),S=m.reduceKeys(O,d.ARIA_PROPS),k=b("p-checkbox p-component",{"p-checkbox-checked":h,"p-checkbox-disabled":l.disabled,"p-checkbox-focused":a},l.className),I=b("p-checkbox-box",{"p-highlight":h,"p-disabled":l.disabled,"p-focus":a}),w="p-checkbox-icon p-c",C=v.getJSXIcon(h?l.icon||e.createElement(E,{className:w}):null,{className:w},{props:l,checked:h});return e.createElement(e.Fragment,null,e.createElement("div",x({ref:u,id:l.id,className:k,style:l.style},O,{onClick:p,onContextMenu:l.onContextMenu,onMouseDown:l.onMouseDown}),e.createElement("div",{className:"p-hidden-accessible"},e.createElement("input",x({ref:s,type:"checkbox",id:l.inputId,name:l.name,tabIndex:l.tabIndex,defaultChecked:h,onFocus:function(){c(!0)},onBlur:function(){c(!1)},onKeyDown:function(e){"Space"!==e.code&&" "!==e.key||p(e)},disabled:l.disabled,readOnly:l.readOnly,required:l.required},S))),e.createElement("div",{className:I},C)),g&&e.createElement(f,x({target:u,content:l.tooltip},l.tooltipOptions)))})));function X(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?X(Object(n),!0).forEach((function(t){P(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}J.displayName="Checkbox";var B=e.memo((function(t){var l={filter:function(e){return r(e)},reset:function(){return t.resetFilter()}},r=function(e){t.onFilter&&t.onFilter({originalEvent:e,query:e.target.value})},o=function(e){t.onSelectAll&&t.onSelectAll({originalEvent:e,checked:t.selectAll}),e.preventDefault()},i=function(){var n="p-multiselect-filter-icon",o=v.getJSXIcon(t.filterIcon||e.createElement(I,{className:n}),{className:n},{props:t});if(t.filter){var i=b("p-multiselect-filter-container"),a=e.createElement("div",{className:i},e.createElement(S,{ref:t.filterRef,type:"text",role:"textbox",value:t.filterValue,onChange:r,className:"p-multiselect-filter",placeholder:t.filterPlaceholder}),o);if(t.filterTemplate)a=m.getJSXElement(t.filterTemplate,{className:i,element:a,filterOptions:l,onFilter:r,filterIconClassName:n,props:t});return e.createElement(e.Fragment,null,a)}return null}(),a="p-checkbox-icon p-c",c=v.getJSXIcon(t.itemCheckboxIcon||e.createElement(E,{className:a}),{className:a},{selected:t.selected}),s=t.showSelectAll?e.createElement(J,{checked:t.selectAll,onChange:o,role:"checkbox","aria-checked":t.selectAll,icon:c}):null,p={className:"p-multiselect-close-icon","aria-hidden":!0},f=v.getJSXIcon(t.closeIcon||e.createElement(u,p),q({},p),{props:t}),d=e.createElement("button",{type:"button",className:"p-multiselect-close p-link","aria-label":n("close"),onClick:t.onClose},f,e.createElement(k,null)),y=e.createElement("div",{className:"p-multiselect-header"},s,i,d);return t.template?m.getJSXElement(t.template,{className:"p-multiselect-header",checkboxElement:s,checked:t.selectAll,onChange:o,filterElement:i,closeElement:d,closeElementClassName:"p-multiselect-close p-link",closeIconClassName:"p-multiselect-close-icon",onCloseClick:t.onClose,element:y,itemCheckboxIcon:c,props:t}):y}));B.displayName="MultiSelectHeader";var _=e.memo((function(t){var n=b("p-multiselect-item",{"p-highlight":t.selected,"p-disabled":t.disabled},t.className,t.option.className),l=b("p-checkbox-box",{"p-highlight":t.selected}),r="p-checkbox-icon p-c",o=t.selected?v.getJSXIcon(t.checkboxIcon||e.createElement(E,{className:r}),{className:r},{selected:t.selected}):null,i=t.template?m.getJSXElement(t.template,t.option):t.label;return e.createElement("li",{className:n,style:t.style,onClick:function(e){t.onClick&&t.onClick({originalEvent:e,option:t.option}),e.preventDefault()},tabIndex:t.disabled?null:t.tabIndex||0,onKeyDown:function(e){t.onKeyDown&&t.onKeyDown({originalEvent:e,option:t.option})},role:"option","aria-selected":t.selected},e.createElement("div",{className:"p-checkbox p-component"},e.createElement("div",{className:l},o)),e.createElement("span",null,i),e.createElement(k,null))}));function z(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach((function(t){P(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}_.displayName="MultiSelectItem";var Y=e.memo(e.forwardRef((function(l,r){var o,i,a,c,u,s=e.useRef(null),p=e.useRef(null),f=function(){l.onEnter((function(){if(s.current){var e=l.getSelectedOptionIndex();-1!==e&&setTimeout((function(){return s.current.scrollToIndex(e)}),0)}}))},v=function(){l.onEntered((function(){l.filter&&l.filterInputAutoFocus&&p.current&&d.focus(p.current,!1)}))},y=function(e){s.current&&s.current.scrollToIndex(0),l.onFilterInputChange&&l.onFilterInputChange(e)},E=function(){if(l.panelFooterTemplate){var t=m.getJSXElement(l.panelFooterTemplate,l,l.onOverlayHide);return e.createElement("div",{className:"p-multiselect-footer"},t)}return null},S=function(t,n){return l.getOptionGroupChildren(t).map((function(t,r){var o=l.getOptionLabel(t),i=r+"_"+l.getOptionRenderKey(t),a=l.isOptionDisabled(t),c=a?null:l.tabIndex||0,u=l.isSelected(t);return e.createElement(_,{key:i,label:o,option:t,style:n,template:l.itemTemplate,selected:u,onClick:l.onOptionSelect,onKeyDown:l.onOptionKeyDown,tabIndex:c,disabled:a,className:l.itemClassName,checkboxIcon:l.checkboxIcon})}))},k=function(){var t=m.getJSXElement(l.emptyFilterMessage,l)||n("emptyFilterMessage");return e.createElement("li",{className:"p-multiselect-empty-message"},t)},I=function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o={height:r.props?r.props.itemSize:void 0};if(l.optionGroupLabel){var i=l.optionGroupTemplate?m.getJSXElement(l.optionGroupTemplate,t,n):l.getOptionGroupLabel(t),a=S(t,o),c=n+"_"+l.getOptionGroupRenderKey(t);return e.createElement(e.Fragment,{key:c},e.createElement("li",{className:"p-multiselect-item-group",style:o},i),a)}var u=l.getOptionLabel(t),s=n+"_"+l.getOptionRenderKey(t),p=l.isOptionDisabled(t),f=p?null:l.tabIndex||0,d=l.isSelected(t);return e.createElement(_,{key:s,label:u,option:t,style:o,template:l.itemTemplate,selected:d,onClick:l.onOptionSelect,onKeyDown:l.onOptionKeyDown,tabIndex:f,disabled:p,className:l.itemClassName,checkboxIcon:l.checkboxIcon})},w=function(){if(l.virtualScrollerOptions){var t=U(U({},l.virtualScrollerOptions),{style:U(U({},l.virtualScrollerOptions.style),{height:l.scrollHeight}),className:b("p-multiselect-items-wrapper",l.virtualScrollerOptions.className),items:l.visibleOptions,autoSize:!0,onLazyLoad:function(e){return l.virtualScrollerOptions.onLazyLoad(U(U({},e),{filter:l.filterValue}))},itemTemplate:function(e,t){return e&&I(e,t.index,t)},contentTemplate:function(t){var n=b("p-multiselect-items p-component",t.className),r=l.visibleOptions&&l.visibleOptions.length||!l.hasFilter?t.children:k();return e.createElement("ul",{ref:t.contentRef,style:t.style,className:n,role:"listbox","aria-multiselectable":!0},r)}});return e.createElement(O,x({ref:s},t))}var n=m.isNotEmpty(l.visibleOptions)?l.visibleOptions.map(I):l.hasFilter?k():null;return e.createElement("div",{className:"p-multiselect-items-wrapper",style:{maxHeight:l.scrollHeight}},e.createElement("ul",{className:"p-multiselect-items p-component",role:"listbox","aria-multiselectable":!0},n))},C=(o=l.allowOptionSelect(),i=b("p-multiselect-panel p-component",{"p-multiselect-inline":l.inline,"p-multiselect-flex":l.flex,"p-multiselect-limited":!o,"p-input-filled":"filled"===t.inputStyle,"p-ripple-disabled":!1===t.ripple},l.panelClassName),a=e.createElement(B,{filter:l.filter,filterRef:p,filterValue:l.filterValue,filterTemplate:l.filterTemplate,onFilter:y,filterPlaceholder:l.filterPlaceholder,onClose:l.onCloseClick,showSelectAll:l.showSelectAll,selectAll:l.isAllSelected(),onSelectAll:l.onSelectAll,template:l.panelHeaderTemplate,resetFilter:l.resetFilter,closeIcon:l.closeIcon,filterIcon:l.filterIcon,itemCheckboxIcon:l.itemCheckboxIcon}),c=w(),u=E(),l.inline?e.createElement("div",{ref:r,className:i,style:l.panelStyle,onClick:l.onClick},c,u):e.createElement(h,{nodeRef:r,classNames:"p-connected-overlay",in:l.in,timeout:{enter:120,exit:100},options:l.transitionOptions,unmountOnExit:!0,onEnter:f,onEntered:v,onExit:l.onExit,onExited:l.onExited},e.createElement("div",{ref:r,className:i,style:l.panelStyle,onClick:l.onClick},a,c,u)));return l.inline?C:e.createElement(g,{element:C,appendTo:l.appendTo})})));function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);t&&(l=l.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,l)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach((function(t){P(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Q(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=W(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var l=0,r=function(){};return{s:r,n:function(){return l>=e.length?{done:!0}:{done:!1,value:e[l++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){a=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(a)throw o}}}}function W(e,t){if(e){if("string"==typeof e)return ee(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ee(e,t):void 0}}function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,l=new Array(t);n<t;n++)l[n]=e[n];return l}Y.displayName="MultiSelectPanel";var te=e.memo(e.forwardRef((function(n,o){var h=G.getProps(n),g=K(e.useState(""),2),O=g[0],E=g[1],S=K(e.useState(!1),2),k=S[0],I=S[1],w=K(e.useState(h.inline),2),C=w[0],N=w[1],D=e.useRef(null),F=e.useRef(h.inputRef),j=e.useRef(null),A=e.useRef(null),L=O&&O.trim().length>0,R=m.isEmpty(h.value),M=h.optionValue?null:h.dataKey,V=K(i({target:D,overlay:A,listener:function(e,t){t.valid&&("outside"===t.type?!te(e)&&W():W())},when:C}),2),H=V[0],J=V[1],X=function(){return!h.selectionLimit||!h.value||h.value&&h.value.length<h.selectionLimit},q=function(e){var t=e.originalEvent,n=e.option;if(!h.disabled&&!se(n)){var l=ce(n),r=pe(n),o=re(n),i=X();o?z(t,h.value.filter((function(e){return!m.equals(r?e:ce(e),l,M)})),n):i&&z(t,[].concat(T(h.value||[]),[l]),n)}},B=function e(t){var n=t.nextElementSibling;return n?d.hasClass(n,"p-disabled")||d.hasClass(n,"p-multiselect-item-group")?e(n):n:null},_=function e(t){var n=t.previousElementSibling;return n?d.hasClass(n,"p-disabled")||d.hasClass(n,"p-multiselect-item-group")?e(n):n:null},z=function(e,t,n){h.onChange&&h.onChange({originalEvent:e,value:t,selectedOption:n,stopPropagation:function(){e.stopPropagation()},preventDefault:function(){e.preventDefault()},target:{name:h.name,id:h.id,value:t}})},U=function(){E(""),h.onFilter&&h.onFilter({filter:""})},$=function(){N(!0)},W=function(){N(!1)},ee=function(){d.alignOverlay(A.current,j.current.parentElement,h.appendTo||t.appendTo)},te=function(e){return d.hasClass(e.target,"p-multiselect-clear-icon")},ne=function(e){return A.current&&A.current.contains(e.target)},le=function(e,t){return t.findIndex((function(t){return e.some((function(e){return m.equals(e,ce(t),M)}))}))},re=function(e){if(h.value){var t=ce(e),n=pe(e);return h.value.some((function(e){return m.equals(n?e:ce(e),t,M)}))}return!1},oe=function(e){var t;if(h.options)if(h.optionGroupLabel){var n,l=Q(h.options);try{for(l.s();!(n=l.n()).done;){if(t=ie(e,ue(n.value)))break}}catch(e){l.e(e)}finally{l.f()}}else t=ie(e,h.options);return t?ae(t):null},ie=function(e,t){return t.find((function(t){return m.equals(ce(t),e,M)}))},ae=function(e){return h.optionLabel?m.resolveFieldData(e,h.optionLabel):e&&void 0!==e.label?e.label:e},ce=function(e){if(h.useOptionAsValue)return e;if(h.optionValue){var t=m.resolveFieldData(e,h.optionValue);return null!==t?t:e}return e&&void 0!==e.value?e.value:e},ue=function(e){return m.resolveFieldData(e,h.optionGroupChildren)},se=function(e){return h.optionDisabled?m.isFunction(h.optionDisabled)?h.optionDisabled(e):m.resolveFieldData(e,h.optionDisabled):!(!e||void 0===e.disabled)&&e.disabled},pe=function(e){return!h.useOptionAsValue&&h.optionValue||e&&void 0!==e.value},fe=function(e,t){var n=h.value.filter((function(e){return!m.equals(e,t,M)}));z(e,n,t)},me=function(){var e=/{(.*?)}/;return e.test(h.selectedItemsLabel)?h.selectedItemsLabel.replace(h.selectedItemsLabel.match(e)[0],h.value.length+""):h.selectedItemsLabel},de=function(){if(!R&&!h.fixedPlaceholder)return m.isNotEmpty(h.maxSelectedLabels)&&h.value.length>h.maxSelectedLabels?me():h.value.reduce((function(e,t,n){return e+(0!==n?",":"")+oe(t)}),"")};e.useImperativeHandle(o,(function(){return{props:h,show:$,hide:W,focus:function(){return d.focus(F.current)},getElement:function(){return D.current},getOverlay:function(){return A.current},getInput:function(){return F.current}}})),e.useEffect((function(){m.combinedRefs(F,h.inputRef)}),[F,h.inputRef]),e.useEffect((function(){setTimeout((function(){h.overlayVisible?$():W()}),100)}),[h.overlayVisible]),r((function(){C&&L&&ee()}),[C,L]),a((function(){y.clear(A.current)}));var be=function(){if(L){var e=O.trim().toLocaleLowerCase(h.filterLocale),t=h.filterBy?h.filterBy.split(","):[h.optionLabel||"label"];if(h.optionGroupLabel){var n,r=[],o=Q(h.options);try{for(o.s();!(n=o.n()).done;){var i=n.value,a=l.filter(ue(i),t,e,h.filterMatchMode,h.filterLocale);a&&a.length&&r.push(Z(Z({},i),P({},h.optionGroupChildren,a)))}}catch(e){o.e(e)}finally{o.f()}return r}return l.filter(h.options,t,e,h.filterMatchMode,h.filterLocale)}return h.options}(),ve=m.isNotEmpty(h.tooltip),ye=G.getOtherProps(h),he=m.reduceKeys(ye,d.ARIA_PROPS),ge=b("p-multiselect p-component p-inputwrapper",{"p-multiselect-chip":"chip"===h.display,"p-disabled":h.disabled,"p-multiselect-clearable":h.showClear&&!h.disabled,"p-focus":k,"p-inputwrapper-filled":m.isNotEmpty(h.value),"p-inputwrapper-focus":k||C},h.className),Oe="p-multiselect-trigger-icon p-c",Ee=e.createElement("div",{className:"p-multiselect-trigger"},h.dropdownIcon?v.getJSXIcon(h.dropdownIcon,{className:Oe},{props:h}):e.createElement(c,{className:Oe})),Se=!h.inline&&function(){var t=h.selectedItemTemplate?R?m.getJSXElement(h.selectedItemTemplate):m.isNotEmpty(h.maxSelectedLabels)&&h.value.length>h.maxSelectedLabels?me():h.value.map((function(t,n){var l=m.getJSXElement(h.selectedItemTemplate,t);return e.createElement(e.Fragment,{key:n},l)})):"chip"!==h.display||R?de():h.value.slice(0,h.maxSelectedLabels||h.value.length).map((function(t){var n=oe(t),l=!h.disabled&&(h.removeIcon?v.getJSXIcon(h.removeIcon,{className:"p-multiselect-token-icon",onClick:function(e){return fe(e,t)}},{props:h}):e.createElement(s,{className:"p-multiselect-token-icon",onClick:function(e){return fe(e,t)}}));return e.createElement("div",{className:"p-multiselect-token",key:n},e.createElement("span",{className:"p-multiselect-token-label"},n),l)})),n=b("p-multiselect-label",{"p-placeholder":R&&h.placeholder,"p-multiselect-label-empty":R&&!h.placeholder&&!h.selectedItemTemplate,"p-multiselect-items-label":!R&&"chip"!==h.display&&h.value.length>h.maxSelectedLabels});return e.createElement("div",{ref:j,className:"p-multiselect-label-container"},e.createElement("div",{className:n},t||h.placeholder||"empty"))}(),ke=!h.inline&&function(){var t={className:"p-multiselect-clear-icon",onClick:function(e){return z(e,null,null)}},n=v.getJSXIcon(h.clearIcon||e.createElement(u,t),Z({},t),{props:h});return R||!h.showClear||h.disabled?null:n}();return e.createElement(e.Fragment,null,e.createElement("div",x({ref:D,id:h.id,style:h.style,className:ge},ye,{onClick:function(e){h.inline||h.disabled||ne(e)||d.hasClass(e.target,"p-multiselect-token-icon")||te(e)||(C?W():$(),d.focus(F.current),e.preventDefault())}}),e.createElement("div",{className:"p-hidden-accessible"},e.createElement("input",x({ref:F,id:h.inputId,name:h.name,readOnly:!0,type:"text",onFocus:function(e){I(!0),h.onFocus&&h.onFocus(e)},onBlur:function(e){I(!1),h.onBlur&&h.onBlur(e)},onKeyDown:function(e){switch(e.which){case 40:if(h.inline)break;!C&&e.altKey&&($(),e.preventDefault());break;case 32:if(h.inline)break;C?W():$(),e.preventDefault();break;case 27:if(h.inline)break;W();break;case 9:if(C){var t=d.getFirstFocusableElement(A.current);t&&(t.focus(),e.preventDefault())}}},role:"listbox","aria-expanded":C,disabled:h.disabled,tabIndex:h.tabIndex},he))),!h.inline&&e.createElement(e.Fragment,null,Se,ke,Ee),e.createElement(Y,x({ref:A,visibleOptions:be},h,{onClick:function(e){p.emit("overlay-click",{originalEvent:e,target:D.current})},onOverlayHide:W,filterValue:O,hasFilter:L,onFilterInputChange:function(e){var t=e.query;E(t),h.onFilter&&h.onFilter({originalEvent:e,filter:t})},resetFilter:U,onCloseClick:function(e){W(),d.focus(F.current),e.preventDefault(),e.stopPropagation()},onSelectAll:function(e){if(h.onSelectAll)h.onSelectAll(e);else{var t=null;if(e.checked){if(t=[],be){var n=be.filter((function(e){return se(e)&&re(e)}));t=n.map((function(e){return ce(e)}))}}else if(be){var l=be.filter((function(e){return!se(e)}));h.optionGroupLabel?(t=[],l.forEach((function(e){return t=[].concat(T(t),T(ue(e).filter((function(e){return!se(e)})).map((function(e){return ce(e)}))))}))):t=l.map((function(e){return ce(e)}))}z(e.originalEvent,t,t)}},getOptionLabel:ae,getOptionRenderKey:function(e){return h.dataKey?m.resolveFieldData(e,h.dataKey):ae(e)},isOptionDisabled:se,getOptionGroupChildren:ue,getOptionGroupLabel:function(e){return m.resolveFieldData(e,h.optionGroupLabel)},getOptionGroupRenderKey:function(e){return m.resolveFieldData(e,h.optionGroupLabel)},isSelected:re,getSelectedOptionIndex:function(){if(null!=h.value&&h.options){if(h.optionGroupLabel){var e=0,t=h.options.findIndex((function(t,n){return(e=n)&&-1!==le(h.value,ue(t))}));return-1!==t?{group:e,option:t}:-1}return le(h.value,h.options)}return-1},isAllSelected:function(){if(h.onSelectAll)return h.selectAll;if(m.isEmpty(be))return!1;var e=be.filter((function(e){return!se(e)}));if(!h.optionGroupLabel)return!e.some((function(e){return!re(e)}));var t,n=Q(e);try{for(n.s();!(t=n.n()).done;){return!ue(t.value).filter((function(e){return!se(e)})).some((function(e){return!re(e)}))}}catch(e){n.e(e)}finally{n.f()}return!0},onOptionSelect:q,allowOptionSelect:X,onOptionKeyDown:function(e){var t=e.originalEvent,n=t.currentTarget;switch(t.which){case 40:var l=B(n);l&&l.focus(),t.preventDefault();break;case 38:var r=_(n);r&&r.focus(),t.preventDefault();break;case 13:case 32:q(e),t.preventDefault();break;case 27:W(),d.focus(F.current)}},in:C,onEnter:function(e){var n;y.set("overlay",A.current,t.autoZIndex,t.zIndex.overlay),ee(),(n=d.findSingle(A.current,"li.p-highlight"))&&n.scrollIntoView&&n.scrollIntoView({block:"nearest",inline:"nearest"}),e&&e()},onEntered:function(e){e&&e(),H(),h.onShow&&h.onShow()},onExit:function(){J()},onExited:function(){h.filter&&h.resetFilterOnHide&&U(),y.clear(A.current),h.onHide&&h.onHide()}}))),ve&&e.createElement(f,x({target:D,content:h.tooltip},h.tooltipOptions)))})));te.displayName="MultiSelect";export{te as MultiSelect};
