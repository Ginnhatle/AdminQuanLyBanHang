import*as e from"react";import t from"primereact/api";import{CSSTransition as n}from"primereact/csstransition";import{useOverlayListener as r,useUnmountEffect as o}from"primereact/hooks";import{OverlayService as l}from"primereact/overlayservice";import{Portal as a}from"primereact/portal";import{ZIndexUtils as i,classNames as u,mergeProps as c,DomHandler as p,IconUtils as s,ObjectUtils as m}from"primereact/utils";import{ComponentBase as f}from"primereact/componentbase";function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function b(e,t){if("object"!==d(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function y(e){var t=b(e,"string");return"symbol"===d(t)?t:String(t)}function v(e,t,n){return(t=y(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e){if(Array.isArray(e))return e}function h(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,l,a,i=[],u=!0,c=!1;try{if(l=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=l.call(n)).done)&&(i.push(r.value),i.length!==t);u=!0);}catch(e){c=!0,o=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return i}}function E(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function O(e,t){if(e){if("string"==typeof e)return E(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?E(e,t):void 0}}function S(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function w(e,t){return g(e)||h(e,t)||O(e,t)||S()}var j=f.extend({defaultProps:{__TYPE:"Menu",id:null,model:null,popup:!1,popupAlignment:"left",style:null,className:null,autoZIndex:!0,baseZIndex:0,appendTo:null,transitionOptions:null,onShow:null,onHide:null,children:void 0}});function N(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?N(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var P=e.memo(e.forwardRef((function(f,d){var b=j.getProps(f),y=w(e.useState(!b.popup),2),v=y[0],g=y[1],h=j.setMetaData({props:b,state:{visible:v}}).ptm,E=e.useRef(null),O=e.useRef(null),S=w(r({target:O,overlay:E,listener:function(e,t){t.valid&&H(e)},when:v}),2),N=S[0],P=S[1],I=function(e,t){t.disabled?e.preventDefault():(t.url||e.preventDefault(),t.command&&t.command({originalEvent:e,item:t}),b.popup&&H(e))},k=function(e,t){var n=e.currentTarget.parentElement;switch(e.which){case 40:var r=D(n);r&&r.children[0].focus(),e.preventDefault();break;case 38:var o=C(n);o&&o.children[0].focus(),e.preventDefault()}},D=function e(t){var n=t.nextElementSibling;return n?p.hasClass(n,"p-disabled")||!p.hasClass(n,"p-menuitem")?e(n):n:null},C=function e(t){var n=t.previousElementSibling;return n?p.hasClass(n,"p-disabled")||!p.hasClass(n,"p-menuitem")?e(n):n:null},T=function(e){b.popup&&(v?H(e):A(e))},A=function(e){O.current=e.currentTarget,g(!0),b.onShow&&b.onShow(e)},H=function(e){O.current=e.currentTarget,g(!1),b.onHide&&b.onHide(e)},_=function(){i.set("menu",E.current,t.autoZIndex,b.baseZIndex||t.zIndex.menu),p.absolutePosition(E.current,O.current,b.popupAlignment)},M=function(){N()},R=function(){O.current=null,P()},Z=function(){i.clear(E.current)};o((function(){i.clear(E.current)})),e.useImperativeHandle(d,(function(){return{props:b,toggle:T,show:A,hide:H,getElement:function(){return E.current},getTarget:function(){return O.current}}}));var J=function(t,n){var r=t.label+"_"+n,o=u("p-submenu-header",{"p-disabled":t.disabled},t.className),l=t.items.map(X),a=c({className:o,style:t.style,role:"presentation"},h("submenuHeader"));return e.createElement(e.Fragment,{key:r},e.createElement("li",a,t.label),l)},K=function(t){var n=c({key:"separator_"+t,className:"p-menu-separator",role:"separator"},h("separator"));return e.createElement("li",n)},X=function(t,n){if(!1===t.visible)return null;var r=u("p-menuitem",t.className),o=u("p-menuitem-link",{"p-disabled":t.disabled}),l=u("p-menuitem-icon",t.icon),a=c({className:"p-menuitem-icon"},h("icon")),i=s.getJSXIcon(t.icon,x({},a),{props:b}),p=c({className:"p-menuitem-text"},h("label")),f=t.label&&e.createElement("span",p,t.label),d=t.disabled?null:0,y=t.label+"_"+n,v=c({href:t.url||"#",className:o,role:"menuitem",target:t.target,onClick:function(e){return I(e,t)},onKeyDown:function(e){return k(e)},tabIndex:d,"aria-disabled":t.disabled},h("action")),g=e.createElement("a",v,i,f);t.template&&(g=m.getJSXElement(t.template,t,{onClick:function(e){return I(e,t)},onKeyDown:function(e){return k(e)},className:o,tabIndex:d,labelClassName:"p-menuitem-text",iconClassName:l,element:g,props:b}));var E=c({key:y,className:r,style:t.style,role:"none"},h("menuitem"));return e.createElement("li",E,g)},z=function(e,t){return e.separator?K(t):e.items?J(e,t):X(e,t)},F=function(){if(b.model){var r=u("p-menu p-component",{"p-menu-overlay":b.popup,"p-input-filled":"filled"===t.inputStyle,"p-ripple-disabled":!1===t.ripple},b.className),o=b.model.map(z),a=c({ref:E,id:b.id,className:r,style:b.style,onClick:function(e){return t=e,void(b.popup&&l.emit("overlay-click",{originalEvent:t,target:O.current}));var t}},j.getOtherProps(b),h("root")),i=c({className:"p-menu-list p-reset",role:"menu"},h("menu"));return e.createElement(n,{nodeRef:E,classNames:"p-connected-overlay",in:v,timeout:{enter:120,exit:100},options:b.transitionOptions,unmountOnExit:!0,onEnter:_,onEntered:M,onExit:R,onExited:Z},e.createElement("div",a,e.createElement("ul",i,o)))}return null}();return b.popup?e.createElement(a,{element:F,appendTo:b.appendTo}):F})));P.displayName="Menu";export{P as Menu};
