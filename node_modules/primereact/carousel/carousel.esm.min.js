import*as e from"react";import t,{ariaLabel as r}from"primereact/api";import{usePrevious as n,useResizeListener as a,useMountEffect as o,useUpdateEffect as l,useUnmountEffect as c}from"primereact/hooks";import{ChevronDownIcon as u}from"primereact/icons/chevrondown";import{ChevronLeftIcon as i}from"primereact/icons/chevronleft";import{ChevronRightIcon as s}from"primereact/icons/chevronright";import{ChevronUpIcon as m}from"primereact/icons/chevronup";import{Ripple as p}from"primereact/ripple";import{classNames as f,mergeProps as v,UniqueComponentId as d,DomHandler as b,ObjectUtils as h,IconUtils as y}from"primereact/utils";import{ComponentBase as g}from"primereact/componentbase";function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function N(e,t){if("object"!==S(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!==S(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function E(e){var t=N(e,"string");return"symbol"===S(t)?t:String(t)}function I(e,t,r){return(t=E(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function O(e){if(Array.isArray(e))return w(e)}function C(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function P(e,t){if(e){if("string"==typeof e)return w(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?w(e,t):void 0}}function j(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function x(e){if(Array.isArray(e))return e}function k(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o,l,c=[],u=!0,i=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(c.push(n.value),c.length!==t);u=!0);}catch(e){i=!0,a=e}finally{try{if(!u&&null!=r.return&&(l=r.return(),Object(l)!==l))return}finally{if(i)throw a}}return c}}function T(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function R(e,t){return x(e)||k(e,t)||P(e,t)||T()}var V=g.extend({defaultProps:{__TYPE:"Carousel",id:null,value:null,page:0,header:null,footer:null,style:null,className:null,itemTemplate:null,circular:!1,showIndicators:!0,showNavigators:!0,autoplayInterval:0,numVisible:1,numScroll:1,prevIcon:null,nextIcon:null,responsiveOptions:null,orientation:"horizontal",verticalViewPortHeight:"300px",contentClassName:null,containerClassName:null,indicatorsContentClassName:null,onPageChange:null,children:void 0}});function A(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function M(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?A(Object(r),!0).forEach((function(t){I(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var D=e.memo((function(t){var r=t.template(t.item),n=f(t.className,"p-carousel-item",{"p-carousel-item-active":t.active,"p-carousel-item-start":t.start,"p-carousel-item-end":t.end}),a=t.ptm(t.className&&"p-carousel-item-cloned"===t.className?"itemCloned":"item"),o=v({className:n},a);return e.createElement("div",o,r)})),B=e.memo(e.forwardRef((function(g,S){var N=V.getProps(g),E=R(e.useState(N.numVisible),2),I=E[0],w=E[1],x=R(e.useState(N.numScroll),2),k=x[0],T=x[1],A=R(e.useState(N.page*N.numScroll*-1),2),B=A[0],H=A[1],L=R(e.useState(N.page),2),X=L[0],_=L[1],Y=V.setMetaData({props:N,state:{numVisible:I,numScroll:k,totalShiftedItems:B,page:X}}).ptm,z=e.useRef(null),J=e.useRef(null),F=e.useRef(0),U=e.useRef(!!N.autoplayInterval),W=e.useRef(""),$=e.useRef(20),q=e.useRef(null),G=e.useRef(null),K=e.useRef(null),Q=e.useRef(!1),Z=e.useRef(null),ee=n(k),te=n(I),re=n(N.value),ne=n(N.page),ae="vertical"===N.orientation,oe=N.circular||!!N.autoplayInterval,le=oe&&N.value&&N.value.length>=I,ce=N.value?Math.max(Math.ceil((N.value.length-I)/k)+1,0):0,ue=ce&&N.autoplayInterval&&U.current,ie=N.onPageChange&&!ue,se=ie?N.page:X,me=R(a({listener:function(){fe()},when:N.responsiveOptions}),1)[0],pe=function(e,t){var r=B;null!=t?(r=k*t*-1,le&&(r-=I),Q.current=!1):(r+=k*e,Q.current&&(r+=F.current-k*e,Q.current=!1),t=Math.abs(Math.floor((le?r+I:r)/k)));le&&X===ce-1&&-1===e?(r=-1*(N.value.length+I),t=0):le&&0===X&&1===e?(r=0,t=ce-1):t===ce-1&&F.current>0&&(r+=-1*F.current-k*e,Q.current=!0),J.current&&(b.removeClass(J.current,"p-items-hidden"),we(r),J.current.style.transition="transform 500ms ease 0s"),Oe(t),H(r)},fe=function(){if(J.current&&Z.current){for(var e=window.innerWidth,t={numVisible:N.numVisible,numScroll:N.numScroll},r=0;r<Z.current.length;r++){var n=Z.current[r];parseInt(n.breakpoint,10)>=e&&(t=n)}if(k!==t.numScroll){var a=Math.floor(se*k/t.numScroll),o=t.numScroll*a*-1;le&&(o-=t.numVisible),H(o),T(t.numScroll),Oe(a)}I!==t.numVisible&&w(t.numVisible)}},ve=function(e,t){(oe||0!==se)&&pe(1,t),U.current=!1,e.cancelable&&e.preventDefault()},de=function(e,t){(oe||se<ce-1)&&pe(-1,t),U.current=!1,e.cancelable&&e.preventDefault()},be=function(e,t){t>se?de(e,t):t<se&&ve(e,t)},he=function(e){J.current&&"transform"===e.propertyName&&(b.addClass(J.current,"p-items-hidden"),J.current.style.transition="",0!==X&&X!==ce-1||!le||we(B))},ye=function(e){var t=e.changedTouches[0];q.current={x:t.pageX,y:t.pageY}},ge=function(e){e.cancelable&&e.preventDefault()},Se=function(e){var t=e.changedTouches[0];Ne(e,ae?t.pageY-q.current.y:t.pageX-q.current.x)},Ne=function(e,t){Math.abs(t)>$&&(t<0?de(e):ve(e))},Ee=function(){G.current&&clearInterval(G.current)},Ie=function(){K.current||(K.current=b.createInlineStyle(t.nonce));var e,r="\n            .p-carousel[".concat(W.current,"] .p-carousel-item {\n                flex: 1 0 ").concat(100/I,"%\n            }\n        ");if(N.responsiveOptions){Z.current=O(e=N.responsiveOptions)||C(e)||P(e)||j(),Z.current.sort((function(e,r){return h.sort(e.breakpoint,r.breakpoint,-1,t.locale,t.nullSortOrder)}));for(var n=0;n<Z.current.length;n++){var a=Z.current[n];r+="\n                    @media screen and (max-width: ".concat(a.breakpoint,") {\n                        .p-carousel[").concat(W.current,"] .p-carousel-item {\n                            flex: 1 0 ").concat(100/a.numVisible,"%\n                        }\n                    }\n                ")}}K.current.innerHTML=r},we=function(e){J.current&&(J.current.style.transform=ae?"translate3d(0, ".concat(e*(100/I),"%, 0)"):"translate3d(".concat(e*(100/I),"%, 0, 0)"))},Oe=function(e){!ie&&_(e),N.onPageChange&&N.onPageChange({page:e})};e.useImperativeHandle(S,(function(){return{props:N,getElement:function(){return z.current}}})),o((function(){z.current&&(W.current=d(),z.current.setAttribute(W.current,"")),Ie(),fe(),we(B),me()})),l((function(){var e=!1,t=B;if(N.autoplayInterval&&Ee(),ee!==k||te!==I||N.value&&re&&re.length!==N.value.length){F.current=(N.value.length-I)%k;var r=se;0!==ce&&r>=ce&&(Oe(r=ce-1),e=!0),t=r*k*-1,le&&(t-=I),r===ce-1&&F.current>0?(t+=-1*F.current+k,Q.current=!0):Q.current=!1,t!==B&&(H(t),e=!0),we(t)}le&&(0===X?t=-1*I:0===t&&(t=-1*N.value.length,F.current>0&&(Q.current=!0)),t!==B&&(H(t),e=!0)),ne!==N.page&&(N.page>ne&&N.page<=ce-1?pe(-1,N.page):N.page<ne&&pe(1,N.page)),!e&&ue&&(G.current=setInterval((function(){pe(-1,X===ce-1?0:X+1)}),N.autoplayInterval))})),c((function(){N.autoplayInterval&&Ee()}));var Ce=function(){if(N.value&&N.value.length){var t=null,r=null;if(le){var n=null;t=(n=N.value.slice(-1*I)).map((function(t,r){return e.createElement(D,{key:r+"_scloned",className:"p-carousel-item-cloned",template:N.itemTemplate,item:t,active:-1*B===N.value.length+I,start:0===r,end:r===n.length-1,ptm:Y})})),r=(n=N.value.slice(0,I)).map((function(t,r){return e.createElement(D,{key:r+"_fcloned",className:"p-carousel-item-cloned",template:N.itemTemplate,item:t,active:0===B,start:0===r,end:r===n.length-1,ptm:Y})}))}var a=N.value.map((function(t,r){var n=le?-1*(B+I):-1*B,a=n+I-1;return e.createElement(D,{key:r,template:N.itemTemplate,item:t,active:n<=r&&a>=r,start:n===r,end:a===r,ptm:Y})}));return e.createElement(e.Fragment,null,t,a,r)}},Pe=function(){if(N.showNavigators){var t=(!oe||N.value&&N.value.length<I)&&0===se,n=f("p-carousel-prev p-link",{"p-disabled":t}),a=v({className:"p-carousel-prev-icon"},Y("previousButtonIcon")),o=y.getJSXIcon(ae?N.prevIcon||e.createElement(m,a):N.prevIcon||e.createElement(i,a),M({},a),{props:N}),l=v({type:"button",className:n,onClick:function(e){return ve(e)},disabled:t,"aria-label":r("previousPageLabel")},Y("previousButton"));return e.createElement("button",l,o,e.createElement(p,null))}return null},je=function(){if(N.showNavigators){var t=(!oe||N.value&&N.value.length<I)&&(se===ce-1||0===ce),n=f("p-carousel-next p-link",{"p-disabled":t}),a=v({className:"p-carousel-next-icon"},Y("nextButtonIcon")),o=y.getJSXIcon(ae?N.nextIcon||e.createElement(u,a):N.nextIcon||e.createElement(s,a),M({},a),{props:N}),l=v({type:"button",className:n,onClick:function(e){return de(e)},disabled:t,"aria-label":r("nextPageLabel")},Y("nextButton"));return e.createElement("button",l,o,e.createElement(p,null))}return null},xe=function(t){var n="carousel-indicator-"+t,a=f("p-carousel-indicator",{"p-highlight":se===t}),o=v({key:n,className:a},Y("indicator")),l=v({type:"button",className:"p-link",onClick:function(e){return be(e,t)},"aria-label":"".concat(r("pageLabel")," ").concat(t+1)},Y("indicatorButton"));return e.createElement("li",o,e.createElement("button",l,e.createElement(p,null)))},ke=f("p-carousel p-component",{"p-carousel-vertical":ae,"p-carousel-horizontal":!ae},N.className),Te=f("p-carousel-content",N.contentClassName),Re=function(){var t=Ce(),r=ae?N.verticalViewPortHeight:"auto",n=Pe(),a=je(),o=f("p-carousel-container",N.containerClassName),l=v({className:"p-carousel-items-content",style:{height:r},onTouchStart:function(e){return ye(e)},onTouchMove:function(e){return ge(e)},onTouchEnd:function(e){return Se(e)}},Y("itemsContent")),c=v({className:o},Y("container")),u=v({ref:J,className:"p-carousel-items-container",onTransitionEnd:he},Y("itemsContainer"));return e.createElement("div",c,n,e.createElement("div",l,e.createElement("div",u,t)),a)}(),Ve=function(){if(N.showIndicators){for(var t=f("p-carousel-indicators p-reset",N.indicatorsContentClassName),r=[],n=0;n<ce;n++)r.push(xe(n));var a=v({className:t},Y("indicators"));return e.createElement("ul",a,r)}return null}(),Ae=function(){if(N.header){var t=v({className:"p-carousel-header"},Y("header"));return e.createElement("div",t,N.header)}return null}(),Me=function(){if(N.footer){var t=v({className:"p-carousel-footer"},Y("footer"));return e.createElement("div",t,N.footer)}return null}(),De=v({id:N.id,ref:z,className:ke,style:N.style},V.getOtherProps(N),Y("root")),Be=v({className:Te},Y("content"));return e.createElement("div",De,Ae,e.createElement("div",Be,Re,Ve),Me)})));D.displayName="CarouselItem",B.displayName="Carousel";export{B as Carousel};
